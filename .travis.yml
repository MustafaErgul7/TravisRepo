---
dist: xenial
jobs:
  include:
    - stage: warm_cache
      script:
        - echo $TRAVIS_TEST_RESULT >> test.sh
      workspaces:
        create:
          name: ws1
          paths:
            - test.sh
    - stage: warm_cache2_fail
      script:
        - cmake
        - sed -i.bck '$s/$/$TRAVIS_TEST_RESULT' test.sh
      workspaces:
        create:
          name: ws1
          paths:
            - test.sh
    - stage: use_cache
      workspaces:
        use: ws1
      script:
        - cat test.sh || true

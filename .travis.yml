---
os: linux
dist: focal
language: python
python:
  - 3.7

branches:
  only:
    - master

env:
  global:
    - CIBW_BUILD=cp38-*
      - CIBW_SKIP=cp38-musllinux*

jobs:
  include:
    # perform a linux build
    - sudo: required
      services: docker
      env: PLAT=manylinux2014_x86_64
    # perform a linux ARMv8 build
    - sudo: required
      services: docker
      arch: arm64
      env: PLAT=manylinux2014_arm64 CIBW_ARCHS_LINUX=aarch64 CIBW_ARCHS=aarch64
    # perform a linux PPC64LE build
    - sudo: required
      services: docker
      arch: ppc64le
      env: PLAT=manylinux2014_ppc64le CIBW_ARCHS_LINUX=ppc64le CIBW_ARCHS=ppc64le
    # perform a linux S390X build
    - sudo: required
      services: docker
      arch: s390x
      env: PLAT=manylinux2014_s390x
    # and a windows build
    - sudo: required
      os: windows
      language: shell
      env: PLAT=Windows
      before_install:
        - choco upgrade python -y --version 3.8.6
        - export PATH="/c/Python38:/c/Python38/Scripts:$PATH"
        # make sure it's on PATH as 'python3'
        - ln -s /c/Python38/python.exe /c/Python38/python3.exe

install:
  - python3 -m pip install cibuildwheel==2.3.1

script:
  - python3 -m cibuildwheel --output-dir wheelhouse

after_failure: echo "this job is failed"

###############################################################################
notifications:
  email:
    recipients:
      - "mustafa@travis-ci.org"
    on_success: always # default: change
    on_failure: always # default: always
  slack:
    secure: VoE5SUTQ3VkkJGyOOcpNJ4X1FyphB22Qa8Q27ZCYluhw1L02k2r/vWIsIGWe2KfStTlFupFeKqeF8QOYD8l9BxwOK6l7lDR9PUbR5paV8nD0wMs7OA8msTYXpvJH46fVdrmqVyRBFc+RE3ORw00TsHbShiNR+8zAhoEYFiwROZVsVvIBTfV4TZedYi6OW5Rg2NInf4mNX0fPKRVJTZ/euK+NIaKRticpAw0qfxK+seAyJ5UjqJ5QjMUa1lebq4vAETgk5g41ghQuhdLq1GIs7Na8+sCaQk+Yax4OxEsyy5yRmEkohxt0+cMHMKApbHl/5y2rQA6m5iJ8HliRJuWkSvTOxPeY2oQ4i8R7zY6l9y5IcYdU1M9MjfHzt0nQ6m4UUna0AWLdumGifhI+l8XtVhbHpQ2xd0oNVmOfF636JG+80WH3JJcbsOt8fwaxNeZP/HarpIB1XVrRtnVh3JaGsu3O1T6zoTZUBUwspQKK7k1Fl8sso+lCTNhoTPjgTiloOGhBFA4vBDF1U/JRdTksbXeLdx51Jx/8kyU6IXjsOU6bZLz3jZMRpQzy5TkNAO51mYnx4RoQF/QrBKSTp1OjZh+CaWUMBCzFTDqgONTbmesUD2PqbOkifaB1+0Rq9L46sNLM1YS4JZIpWNW6yg30tgjAqryI8Xu1W2Ka8153db4=
